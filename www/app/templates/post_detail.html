<ion-view id="postDetail" view-title="PublicaciÃ³n">
    <ion-content class="padding" class="has-footer">

		<ion-refresher pulling-text="Soltar para refrescar" on-refresh="updatePost()" pulling-icon="ion-loading-c" refreshing-icon="ion-loading-c">
        </ion-refresher>

		<div id="post-detail-content-container" class="item" ng-style="{'background-image':'url(' + post_url + ')'}">
		</div>
		
		<div class="row row-top">
			<div id="post-detail-user-img-container">
				<img id="post-detail-user-img" src="{{model.post.authorImgUrl !== null && model.post.authorImgUrl !== '' ? url + model.post.authorImgUrl : unknown_user}}" alt="Foto de perfil" ng-click="viewProfile(model.post.authorId)"/>
			</div>

			<div class="col post-detail-user-data">
				<span id="post-detail-user-name">{{model.post.authorName}}<br/></span>
				<span ng-show="model.post.authorLocation !== ''" id="post-detail-location">
					<i class="ion-location"></i> {{model.post.authorLocation}}<br/>
				</span>				
				<span><i class="ion-clock"></i> </span><span am-time-ago="model.post.postTimestamp"></span>
			</div>
		</div>

		<div class="row row-bottom">
			<div class="col post-detail-text">{{model.post.text}}</div>
		</div>

		<div class="row">
			<div class="col">
				<span ng-click="toggleLike()">
					<i ng-show="model.post.isLiked" class="ion-ios7-star star-size"></i> 
					<i ng-show="!model.post.isLiked" class="ion-ios7-star-outline star-size"></i> 
					{{model.post.totalStars}}
				</span>
			</div>

			<div class="col" id="post-detail-more" ng-click="showMore()">
				<i class="ion-more"></i>
			</div>
		</div>

		<ion-list>
			<ion-item id="commentTextContainer" class="item-input-inset">
				<textarea id="commentTextArea"
						  ng-model="model.commentText"
						  ng-blur="model.isCommentTextFocus = false" 
						  ng-focus="model.isCommentTextFocus = true" 
						  placeholder="Agrega un comentario...">
				</textarea>
				<button ng-show="model.isCommentTextFocus || model.commentText.length"
						ng-disabled="!model.commentText.length" 
						class="button button-positive button-small ion-edit comment-button" 
						ng-click="addComment()">
				</button>
			</ion-item>

			<ion-item ng-repeat="comment in model.post.comments" class="post-detail-comment-container" on-hold="showDeleteComment(comment.id)">
				<div class="row">
					<div id="post-detail-comment-user-img-container">
						<img id="post-detail-comment-user-img" ng-src="{{comment.authorUrlImage !== '' && comment.authorUrlImage !== null ? url + comment.authorUrlImage : unknown_user}}" ng-click="viewProfile(comment.authorId)"/>
					</div>

					<div class="col col-top">
						<span class="post-detail-comment-user-name">{{comment.authorName}}</span>
						<span class="post-detail-comment-timestamp" am-time-ago="comment.timestamp"></span><br/>
						<span class="post-detail-comment-text">{{comment.text}}</span>
					</div>
				</div>
			</ion-item>
		</ion-list>
	</ion-content>
</ion-view>